services:
  aether-bot:
    build: .
    container_name: aether-bot
    restart: unless-stopped
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - OWNER_ID=${OWNER_ID}
      - COBALT_API=${COBALT_API:-http://cobalt:9000}
      - TELEGRAM_API_ID=${TELEGRAM_API_ID}
      - TELEGRAM_API_HASH=${TELEGRAM_API_HASH}
    volumes:
      - ./data:/app/data
      - ./cookies:/app/cookies
      - ./downloads:/app/downloads
      - /tmp/aether:/tmp/aether
    depends_on:
      - cobalt
    networks:
      - default
    deploy:
      resources:
        limits:
          cpus: "1.0"
          memory: 512M
        reservations:
          cpus: "0.50"
          memory: 256M

  cobalt:
    image: ghcr.io/imputnet/cobalt:latest
    container_name: cobalt
    restart: unless-stopped
    init: true
    ports:
      - "8082:9000"
    environment:
      - API_URL=http://cobalt:9000
    networks:
      - default
    deploy:
      resources:
        limits:
          cpus: "0.5"
          memory: 256M
        reservations:
          cpus: "0.25"
          memory: 128M
volumes:
  telegram-data:
networks:
  default:
    driver: bridge
